"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[2498],{3498:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>g,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"extras-hedgehog/extras-hedgehog-circe/round-trip-tester","title":"RoundTripTester","description":"","source":"@site/../generated-docs/docs/extras-hedgehog/extras-hedgehog-circe/round-trip-tester.md","sourceDirName":"extras-hedgehog/extras-hedgehog-circe","slug":"/extras-hedgehog/extras-hedgehog-circe/round-trip-tester","permalink":"/docs/extras-hedgehog/extras-hedgehog-circe/round-trip-tester","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"id":"round-trip-tester","title":"RoundTripTester"},"sidebar":"tutorialSidebar","previous":{"title":"Getting Started","permalink":"/docs/extras-hedgehog/extras-hedgehog-circe/"},"next":{"title":"Getting Started","permalink":"/docs/extras-hedgehog/extras-hedgehog-ce3/"}}');var o=t(4848),r=t(8453);const s={sidebar_position:2,id:"round-trip-tester",title:"RoundTripTester"},d=void 0,a={},c=[];function h(e){const n={code:"code",pre:"pre",...(0,r.R)(),...e.components};return(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-scala",children:'import extras.hedgehog.circe.RoundTripTester\n\nimport cats._\nimport io.circe._\n\nimport hedgehog._\nimport hedgehog.runner._\n\nobject SomethingSpec extends Properties {\n  override def tests: List[Test] = List(\n    property("round-trip test Something JSON Codec", roundTripTest),\n    property("round-trip test Something JSON Codec - failure case", roundTripTestWithDecodeFailure),\n    property("round-trip test Something JSON Codec - failure case (indent 4)", roundTripTestWithDecodeFailureIndent4),\n  )\n  \n  def roundTripTest: Property =\n    for {\n      something <- genSomething.log("something")\n    } yield {\n      RoundTripTester(something).test()\n    }\n\n  def roundTripTestWithDecodeFailure: Property =\n    for {\n      something <- genSomething\n        .map(something => SomethingWithDecodeFailure(something.id, something.name))\n        .log("something")\n    } yield {\n      RoundTripTester(something).test()\n    }\n\n  def roundTripTestWithDecodeFailureIndent4: Property =\n    for {\n      something <- genSomething\n        .map(something => SomethingWithDecodeFailure(something.id, something.name))\n        .log("something")\n    } yield {\n      RoundTripTester(something)\n        .indent(8)\n        .test()\n    }\n\n  def genSomething: Gen[Something] =\n    for {\n      id <- Gen.int(Range.linear(1, 100))\n      name <- Gen.string(Gen.unicode, Range.linear(3, 20))\n    } yield Something(id, name)\n\n\n  final case class Something(id: Int, name: String)\n  object Something {\n    implicit val somethingShow: Show[Something] =\n      something => s"Something(id = ${something.id.toString}, name = ${something.name})"\n\n    implicit val somethingCodec: Codec[Something] = io.circe.generic.semiauto.deriveCodec\n  }\n\n\n  final case class SomethingWithDecodeFailure(id: Int, name: String)\n\n  object SomethingWithDecodeFailure {\n    implicit val somethingWithDecodeFailureShow: Show[SomethingWithDecodeFailure] =\n      somethingWithDecodeFailure =>\n        List(\n          s"id = ${somethingWithDecodeFailure.id.toString}",\n          s"name = ${somethingWithDecodeFailure.name}",\n        ).mkString(\n          "SomethingWithDecodeFailure(",\n          ", ",\n          ")",\n        )\n\n    implicit val somethingWithDecodeFailureEncoder: Encoder[SomethingWithDecodeFailure] =\n      io.circe.generic.semiauto.deriveEncoder\n\n    implicit val somethingWithDecodeFailureDecoder: Decoder[SomethingWithDecodeFailure] =\n      Decoder.instance(c =>\n        for {\n          id   <- c.downField("blah").as[Int]\n          name <- c.downField("name").as[String]\n        } yield SomethingWithDecodeFailure(id, name)\n      )\n  }\n\n}\n\n\n// This is only for this document so you don\'t need this.\nSomethingSpec.main(Array.empty)\n// Using random seed: 118625762720\n// \x1b[32m+\x1b[0m repl.MdocSession$MdocApp0$SomethingSpec$.round-trip test Something JSON Codec: OK, passed 100 tests\n// \x1b[31m-\x1b[0m repl.MdocSession$MdocApp0$SomethingSpec$.round-trip test Something JSON Codec - failure case: Falsified after 0 passed tests\n// > something: SomethingWithDecodeFailure(1,\ufffd\ufffd\ufffd)\n// > Round-trip test for SomethingSpec.SomethingWithDecodeFailure failed with error:\n// > Error: DecodingFailure at .blah: Missing required field\n// > ---\n// > Input: SomethingWithDecodeFailure(id = 1, name = \ufffd\ufffd\ufffd)\n// > ---\n// > JSON: {\n//   "id" : 1,\n//   "name" : "\\u0000\\u0000\\u0000"\n// }\n// >\n// \x1b[31m-\x1b[0m repl.MdocSession$MdocApp0$SomethingSpec$.round-trip test Something JSON Codec - failure case (indent 4): Falsified after 0 passed tests\n// > something: SomethingWithDecodeFailure(1,\ufffd\ufffd\ufffd)\n// > Round-trip test for SomethingSpec.SomethingWithDecodeFailure failed with error:\n// > Error: DecodingFailure at .blah: Missing required field\n// > ---\n// > Input: SomethingWithDecodeFailure(id = 1, name = \ufffd\ufffd\ufffd)\n// > ---\n// > JSON: {\n//         "id" : 1,\n//         "name" : "\\u0000\\u0000\\u0000"\n// }\n// >\n'})})}function g(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>d});var i=t(6540);const o={},r=i.createContext(o);function s(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);