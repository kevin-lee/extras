"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1755],{1263:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>i,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"extras-hedgehog/extras-hedgehog-ce3/with-runner/run-io","title":"runIO","description":"Module","source":"@site/../generated-docs/docs/extras-hedgehog/extras-hedgehog-ce3/with-runner/run-io.md","sourceDirName":"extras-hedgehog/extras-hedgehog-ce3/with-runner","slug":"/extras-hedgehog/extras-hedgehog-ce3/with-runner/run-io","permalink":"/docs/extras-hedgehog/extras-hedgehog-ce3/with-runner/run-io","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"id":"run-io","title":"runIO"},"sidebar":"tutorialSidebar","previous":{"title":"With CatsEffectRunner","permalink":"/docs/category/with-catseffectrunner"},"next":{"title":"withIO","permalink":"/docs/extras-hedgehog/extras-hedgehog-ce3/with-runner/with-io"}}');var s=r(4848),a=r(8453);const o={sidebar_position:1,id:"run-io",title:"runIO"},c=void 0,i={},d=[{value:"Module",id:"module",level:2},{value:"<code>runIO</code>",id:"runio",level:2},{value:"Test Success Case",id:"test-success-case",level:3},{value:"Test Error Case",id:"test-error-case",level:3}];function l(e){const n={code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"module",children:"Module"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-scala",children:'"io.kevinlee" %% "extras-hedgehog-ce3" % "0.46.1" % Test\n'})}),"\n",(0,s.jsxs)(n.p,{children:["or for ",(0,s.jsx)(n.code,{children:"Scala.js"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-scala",children:'"io.kevinlee" %%% "extras-hedgehog-ce3" % "0.46.1" % Test\n'})}),"\n",(0,s.jsx)(n.h2,{id:"runio",children:(0,s.jsx)(n.code,{children:"runIO"})}),"\n",(0,s.jsxs)(n.p,{children:["If you just run ",(0,s.jsx)(n.code,{children:"IO.unsafeRunSync()"})," in a test, it may not end and just hang. extras for hedgehog and cats-effect 3 (",(0,s.jsx)(n.code,{children:"extras-hedgehog-ce3"}),") can solve it with ",(0,s.jsx)(n.code,{children:"runIO"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-scala",children:"def runIO(test: => IO[Result]): Result\n"})}),"\n",(0,s.jsxs)(n.p,{children:["To use ",(0,s.jsx)(n.code,{children:"runIO"}),", your test needs to extend ",(0,s.jsx)(n.code,{children:"CatsEffectRunner"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-scala",children:"import hedgehog.runner._\nimport extras.hedgehog.ce3.CatsEffectRunner\n\nobject SomeSpec extends Properties with CatsEffectRunner {\n"})}),"\n",(0,s.jsxs)(n.p,{children:["then in your test, use ",(0,s.jsx)(n.code,{children:"runIO"})," like"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-scala",metastring:"{2}",children:"def test: Result = \n  runIO {\n    // Your test\n    val exected = ??? // A\n    val actual = ??? // IO[A]\n    actual.map(_ ==== expected) // IO[Result]\n  }\n"})}),"\n",(0,s.jsx)(n.p,{children:"or"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-scala",metastring:"{4}",children:'def test: Property =\n  for {\n    n <- Gen.int(Range.linear(1, 100)).log("n")\n  } yield runIO {\n    // Your test\n    val exected = ??? // A\n    val actual = ??? // IO[A]\n    actual.map(_ ==== expected) // IO[Result]\n  }\n'})}),"\n",(0,s.jsx)(n.h3,{id:"test-success-case",children:"Test Success Case"}),"\n",(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.code,{children:"CatsEffectRunner"})," and ",(0,s.jsx)(n.code,{children:"completeThen"})," instead of ",(0,s.jsx)(n.code,{children:"unsafeRunSync()"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-scala",metastring:"{8,16,21-23} mdoc:reset-object",children:'import cats.effect._\n\nimport extras.hedgehog.ce3.CatsEffectRunner\n\nimport hedgehog._\nimport hedgehog.runner._\n\nobject SomeSpec extends Properties with CatsEffectRunner {\n  \n  override def tests: List[Test] = List(\n    property("test with CatsEffectRunner and success case", testCatsEffectRunnerWithSuccessCase)\n  )\n  \n  def testCatsEffectRunnerWithSuccessCase: Property = for {\n    n <- Gen.int(Range.linear(Int.MinValue, Int.MaxValue)).log("n")\n  } yield runIO {\n\n    val expected = n\n    val actual = IO(n)\n\n    actual.map { actual =>\n      actual ==== expected\n    } // IO[Result]\n  }\n}\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"test-error-case",children:"Test Error Case"}),"\n",(0,s.jsxs)(n.p,{children:["If you want to test with ",(0,s.jsx)(n.code,{children:"IO"})," which may result in some ",(0,s.jsx)(n.code,{children:"Exception"})," thrown, you can use ",(0,s.jsx)(n.code,{children:"errorThen"})," instead of ",(0,s.jsx)(n.code,{children:"unsafeRunSync()"})," and ",(0,s.jsx)(n.code,{children:"Try"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-scala",metastring:"{8,22,27-32} mdoc:reset-object",children:'import cats.effect._\n\nimport extras.hedgehog.ce3.CatsEffectRunner\n\nimport hedgehog._\nimport hedgehog.runner._\n\nobject SomeSpec extends Properties with CatsEffectRunner {\n\n  override def tests: List[Test] = List(\n    property("test with CatsEffectRunner and erro case", testCatsEffectRunnerWithErrorCase)\n  )\n\n  def testCatsEffectRunnerWithErrorCase: Property = for {\n    message <- Gen.string(Gen.alphaNum, Range.linear(1, 10)).log("message")\n    error <- Gen\n      .element1(\n        TestError.someTestError(s"Don\'t worry it\'s only a test error. $message"),\n        TestError.anotherTestError(s"Don\'t worry it\'s only a test error. $message")\n      )\n      .log("error")\n  } yield runIO {\n\n    val expected = error\n    val actual = IO.raiseError[Int](error)\n\n    actual.attempt.map {\n      case Left(actual) =>\n        actual ==== expected\n      case Right(r) =>\n        Result.failure.log(s"Expected error $expected but got $r instead.")\n    } // IO[Result]\n  }\n\n  sealed abstract class TestError(val message: String) extends RuntimeException(message)\n\n  object TestError {\n    final case class SomeTestError(override val message: String) extends TestError(message)\n    final case class AnotherTestError(override val message: String) extends TestError(message)\n\n    def anotherTestError(message: String): TestError = AnotherTestError(message)\n    def someTestError(message: String): TestError = SomeTestError(message)\n\n  }\n}\n'})})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>c});var t=r(6540);const s={},a=t.createContext(s);function o(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);